<!DOCTYPE html>
<!-- saved from url=(0078)file:///C:/Users/Gordon/AppData/Local/Temp/RtmpaShV5C/preview-1f03e2a4d0e.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<meta name="generator" content="pandoc">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="personal-loan-acceptance">Personal Loan Acceptance</h1>
<p>Gordon Wall (gwall2)</p>
<p>##Load relevant libraries and datafiles</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install.packages("class")</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># install.packages("gmodels")</span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(caret)</a></code></pre></div>
<pre><code>## Loading required package: lattice

## Loading required package: ggplot2
</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(class)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">library</span>(gmodels)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># install.packages("FNN")</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">library</span>(FNN)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'FNN'

## The following objects are masked from 'package:class':
## 
##     knn, knn.cv
</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'

## The following objects are masked from 'package:stats':
## 
##     filter, lag

## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">Universal_Bank &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">"C:/Users/Gordon/Dropbox/KSU MSBA Program/SEMESTER 4/MACHINE LEARNING 64060/Module 4/UniversalBank.csv"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">summary</span>(Universal_Bank)</a></code></pre></div>
<pre><code>##        ID            Age          Experience       Income      
##  Min.   :   1   Min.   :23.00   Min.   :-3.0   Min.   :  8.00  
##  1st Qu.:1251   1st Qu.:35.00   1st Qu.:10.0   1st Qu.: 39.00  
##  Median :2500   Median :45.00   Median :20.0   Median : 64.00  
##  Mean   :2500   Mean   :45.34   Mean   :20.1   Mean   : 73.77  
##  3rd Qu.:3750   3rd Qu.:55.00   3rd Qu.:30.0   3rd Qu.: 98.00  
##  Max.   :5000   Max.   :67.00   Max.   :43.0   Max.   :224.00  
##     ZIP.Code         Family          CCAvg          Education    
##  Min.   : 9307   Min.   :1.000   Min.   : 0.000   Min.   :1.000  
##  1st Qu.:91911   1st Qu.:1.000   1st Qu.: 0.700   1st Qu.:1.000  
##  Median :93437   Median :2.000   Median : 1.500   Median :2.000  
##  Mean   :93153   Mean   :2.396   Mean   : 1.938   Mean   :1.881  
##  3rd Qu.:94608   3rd Qu.:3.000   3rd Qu.: 2.500   3rd Qu.:3.000  
##  Max.   :96651   Max.   :4.000   Max.   :10.000   Max.   :3.000  
##     Mortgage     Personal.Loan   Securities.Account   CD.Account    
##  Min.   :  0.0   Min.   :0.000   Min.   :0.0000     Min.   :0.0000  
##  1st Qu.:  0.0   1st Qu.:0.000   1st Qu.:0.0000     1st Qu.:0.0000  
##  Median :  0.0   Median :0.000   Median :0.0000     Median :0.0000  
##  Mean   : 56.5   Mean   :0.096   Mean   :0.1044     Mean   :0.0604  
##  3rd Qu.:101.0   3rd Qu.:0.000   3rd Qu.:0.0000     3rd Qu.:0.0000  
##  Max.   :635.0   Max.   :1.000   Max.   :1.0000     Max.   :1.0000  
##      Online         CreditCard   
##  Min.   :0.0000   Min.   :0.000  
##  1st Qu.:0.0000   1st Qu.:0.000  
##  Median :1.0000   Median :0.000  
##  Mean   :0.5968   Mean   :0.294  
##  3rd Qu.:1.0000   3rd Qu.:1.000  
##  Max.   :1.0000   Max.   :1.000
</code></pre>
<p>##Convert variable Education to dummy</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">UBdf =<span class="st"> </span><span class="kw">mutate</span>(Universal_Bank, <span class="dt">Education_1 =</span> <span class="kw">ifelse</span>(Education <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb12-2" title="2">UBdf =<span class="st"> </span><span class="kw">mutate</span>(UBdf, <span class="dt">Education_2 =</span> <span class="kw">ifelse</span>(Education <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb12-3" title="3">UBdf =<span class="st"> </span><span class="kw">mutate</span>(UBdf, <span class="dt">Education_3 =</span> <span class="kw">ifelse</span>(Education <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a></code></pre></div>
<p>##Drop irrelevancies (ID, zipcode, original education variable)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">UBdf.temp =<span class="st"> </span>UBdf[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">8</span>)]</a></code></pre></div>
<p>##Partition the data into training (60%) and validation (40%) sets</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">set.seed</span>(<span class="dv">70</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">Train_Index_<span class="dv">1</span> =<span class="st"> </span><span class="kw">createDataPartition</span>(UBdf.temp<span class="op">$</span>Personal.Loan, <span class="dt">p=</span><span class="fl">0.6</span>, <span class="dt">list=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-3" title="3">Train<span class="fl">.1</span> =<span class="st"> </span>UBdf.temp[Train_Index_<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb14-4" title="4">Validation<span class="fl">.1</span> =<span class="st"> </span>UBdf.temp[<span class="op">-</span>Train_Index_<span class="dv">1</span>,]</a></code></pre></div>
<p>##Copy data</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">train.norm.df =<span class="st"> </span>Train<span class="fl">.1</span></a>
<a class="sourceLine" id="cb15-2" title="2">valid.norm.df =<span class="st"> </span>Validation<span class="fl">.1</span></a></code></pre></div>
<p>##Normalize training data</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">norm.values =<span class="st"> </span><span class="kw">preProcess</span>(Train<span class="fl">.1</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">method =</span> <span class="kw">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</a>
<a class="sourceLine" id="cb16-2" title="2">train.norm.df[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>] =<span class="st"> </span><span class="kw">predict</span>(norm.values, Train<span class="fl">.1</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>])</a>
<a class="sourceLine" id="cb16-3" title="3">valid.norm.df[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>] =<span class="st"> </span><span class="kw">predict</span>(norm.values, Validation<span class="fl">.1</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>])</a></code></pre></div>
<p>##k-NN Classification</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">nn1 =<span class="st"> </span><span class="kw">knn</span>(<span class="dt">train =</span> train.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">test =</span> valid.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">cl =</span> train.norm.df[,<span class="dv">7</span>], <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span> )</a></code></pre></div>
<p>##Output</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># print(nn1)</span></a></code></pre></div>
<p>##Create and bind new test observation (given in question 1)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">customer1.df =<span class="st"> </span><span class="kw">rbind</span>(valid.norm.df, <span class="kw">c</span>(<span class="dv">40</span>,<span class="dv">10</span>,<span class="dv">84</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</a></code></pre></div>
<p>##Customer 1 Prediction</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">prediction1 =<span class="st"> </span><span class="kw">knn</span>(<span class="dt">train =</span> train.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">test =</span> customer1.df[<span class="dv">2001</span>,<span class="op">-</span><span class="dv">7</span>], <span class="dt">cl =</span> train.norm.df[,<span class="dv">7</span>], <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span> )</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">row.names</span>(Train<span class="fl">.1</span>)[<span class="kw">attr</span>(prediction1, <span class="st">"nn.index"</span>)]</a></code></pre></div>
<pre><code>## [1] "663"
</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">print</span>(prediction1)</a></code></pre></div>
<pre><code>## [1] 1
## attr(,"prob")
## [1] 1
## attr(,"nn.index")
##      [,1]
## [1,]  416
## attr(,"nn.dist")
##          [,1]
## [1,] 90.50974
## Levels: 1
</code></pre>
<p>The output shows that our test customer’s nearest neighbor is observation 663 in the original training data which, by a quick inspection, seems not all that close in similarity. This is may be due to the fact that our k=1 input is not the most accurate specification of k-neighbors to use for our model. In either case, we will figure out what the right k-value is next but, as of now, the model classifies this test customer as <strong>1</strong>, meaning <strong>Will accept the personal loan.</strong></p>
<p>##Optimal Choice of K</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">accuracy.df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">k =</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">14</span>, <span class="dv">1</span>), <span class="dt">accuracy =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">14</span>))</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">14</span>) {</a>
<a class="sourceLine" id="cb25-2" title="2">  knn.pred =<span class="st"> </span><span class="kw">knn</span>(<span class="dt">train =</span> train.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">test =</span> valid.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">cl =</span> train.norm.df[,<span class="dv">7</span>], <span class="dt">k =</span> i)</a>
<a class="sourceLine" id="cb25-3" title="3">  </a>
<a class="sourceLine" id="cb25-4" title="4">  accuracy.df[i, <span class="dv">2</span>] =<span class="st"> </span><span class="kw">confusionMatrix</span>(knn.pred, <span class="kw">as.factor</span>(valid.norm.df[, <span class="dv">7</span>]))<span class="op">$</span>overall[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb25-5" title="5">}</a>
<a class="sourceLine" id="cb25-6" title="6">accuracy.df</a></code></pre></div>
<pre><code>##     k accuracy
## 1   1   0.9640
## 2   2   0.9530
## 3   3   0.9640
## 4   4   0.9525
## 5   5   0.9595
## 6   6   0.9525
## 7   7   0.9560
## 8   8   0.9510
## 9   9   0.9550
## 10 10   0.9500
## 11 11   0.9535
## 12 12   0.9500
## 13 13   0.9525
## 14 14   0.9475
</code></pre>
<p>It appears that, in fact, k=1 is the most accurate k-value for our model. K=3 has an equal accuracy, so either input would suffice. However, k=1 may be too small as far as modeling too much noise goes, so k=3 may be a smarter choice for the model, which takes in several neighbors as opposed to just one.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">pred.new.df =<span class="st"> </span><span class="kw">knn</span>(<span class="dt">train =</span> train.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">test =</span> valid.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">cl =</span> train.norm.df[,<span class="dv">7</span>], <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span> )</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">CrossTable</span>(<span class="dt">x=</span> valid.norm.df[,<span class="dv">7</span>], <span class="dt">y =</span> pred.new.df, <span class="dt">prop.chisq =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  2000 
## 
##  
##                    | pred.new.df 
## valid.norm.df[, 7] |         0 |         1 | Row Total | 
## -------------------|-----------|-----------|-----------|
##                  0 |      1810 |         3 |      1813 | 
##                    |     0.998 |     0.002 |     0.906 | 
##                    |     0.963 |     0.025 |           | 
##                    |     0.905 |     0.002 |           | 
## -------------------|-----------|-----------|-----------|
##                  1 |        69 |       118 |       187 | 
##                    |     0.369 |     0.631 |     0.093 | 
##                    |     0.037 |     0.975 |           | 
##                    |     0.034 |     0.059 |           | 
## -------------------|-----------|-----------|-----------|
##       Column Total |      1879 |       121 |      2000 | 
##                    |     0.940 |     0.060 |           | 
## -------------------|-----------|-----------|-----------|
## 
## 
</code></pre>
<p>The print out of the confusion matrix shows a total of 72 misclassifications (69 FN, 3 FP), out of 2000 observations. That’s not too bad for a result, which shows that k=3 was a good choice. However, due to the make up of these misclassification in a real-world setting, the fact that there are a disproportionate amount of false negatives is not a good thing. It would be better to solicit false positives for personal loan acceptance and be turned down, than to miss out on soliciting false negatives who would’ve most likely accepted a personal loan if urged to. Thus, the model is decent enough, but not perfect. (some of that may have to do with the fact that this is my first crack at knn modeling xD)</p>
<p>##Classify customer 1 using best k-value</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">prediction2 =<span class="st"> </span><span class="kw">knn</span>(<span class="dt">train =</span> train.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">test =</span> customer1.df[<span class="dv">2001</span>,<span class="op">-</span><span class="dv">7</span>], <span class="dt">cl =</span> train.norm.df[,<span class="dv">7</span>], <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span> )</a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">row.names</span>(Train<span class="fl">.1</span>)[<span class="kw">attr</span>(prediction2, <span class="st">"nn.index"</span>)]</a></code></pre></div>
<pre><code>## [1] "663"  "4293" "3484"
</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">print</span>(prediction1)</a></code></pre></div>
<pre><code>## [1] 1
## attr(,"prob")
## [1] 1
## attr(,"nn.index")
##      [,1]
## [1,]  416
## attr(,"nn.dist")
##          [,1]
## [1,] 90.50974
## Levels: 1
</code></pre>
<p>It appears the customer is still classified as accepting a personal loan, but we can be more confident about this report using a k-value of 3 this time around.</p>
<p>##Repartition data (50, 30, 20)</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">set.seed</span>(<span class="dv">70</span>)</a>
<a class="sourceLine" id="cb33-2" title="2">Test_Index_<span class="dv">2</span> =<span class="st"> </span><span class="kw">createDataPartition</span>(UBdf.temp<span class="op">$</span>Personal.Loan, <span class="dt">p=</span><span class="fl">0.2</span>, <span class="dt">list=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb33-3" title="3">Test<span class="fl">.2</span> =<span class="st"> </span>UBdf.temp[Test_Index_<span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb33-4" title="4">TraVal<span class="fl">.2</span> =<span class="st"> </span>UBdf.temp[<span class="op">-</span>Test_Index_<span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb33-5" title="5"></a>
<a class="sourceLine" id="cb33-6" title="6">Train_Index_<span class="dv">2</span> =<span class="st"> </span><span class="kw">createDataPartition</span>(TraVal<span class="fl">.2</span><span class="op">$</span>Personal.Loan, <span class="dt">p=</span><span class="fl">0.625</span>, <span class="dt">list=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb33-7" title="7">Train<span class="fl">.2</span> =<span class="st"> </span>TraVal<span class="fl">.2</span>[Train_Index_<span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb33-8" title="8">Validation<span class="fl">.2</span> =<span class="st"> </span>TraVal<span class="fl">.2</span>[<span class="op">-</span>Train_Index_<span class="dv">2</span>,]</a></code></pre></div>
<p>##Apply k-NN to data</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">new.train.norm.df =<span class="st"> </span>Train<span class="fl">.2</span></a>
<a class="sourceLine" id="cb34-2" title="2">new.valid.norm.df =<span class="st"> </span>Validation<span class="fl">.2</span></a>
<a class="sourceLine" id="cb34-3" title="3">new.test.norm.df =<span class="st"> </span>Test<span class="fl">.2</span></a>
<a class="sourceLine" id="cb34-4" title="4"></a>
<a class="sourceLine" id="cb34-5" title="5">norm.values =<span class="st"> </span><span class="kw">preProcess</span>(Train<span class="fl">.2</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">method =</span> <span class="kw">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</a>
<a class="sourceLine" id="cb34-6" title="6">new.train.norm.df[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>] =<span class="st"> </span><span class="kw">predict</span>(norm.values, Train<span class="fl">.2</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>])</a>
<a class="sourceLine" id="cb34-7" title="7">new.valid.norm.df[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>] =<span class="st"> </span><span class="kw">predict</span>(norm.values, Validation<span class="fl">.2</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>])</a>
<a class="sourceLine" id="cb34-8" title="8">new.test.norm.df[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>] =<span class="st"> </span><span class="kw">predict</span>(norm.values, Test<span class="fl">.2</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>])</a>
<a class="sourceLine" id="cb34-9" title="9"></a>
<a class="sourceLine" id="cb34-10" title="10">nn2 =<span class="st"> </span><span class="kw">knn</span>(<span class="dt">train =</span> new.train.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">test =</span> new.valid.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">cl =</span> new.train.norm.df[,<span class="dv">7</span>], <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb34-11" title="11"></a>
<a class="sourceLine" id="cb34-12" title="12">nn3 =<span class="st"> </span><span class="kw">knn</span>(<span class="dt">train =</span> new.train.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">test =</span> new.test.norm.df[,<span class="op">-</span><span class="dv">7</span>], <span class="dt">cl =</span> new.train.norm.df[,<span class="dv">7</span>], <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>##Confusion Matrix Comparison</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">CrossTable</span>(<span class="dt">x=</span> new.valid.norm.df[,<span class="dv">7</span>], <span class="dt">y =</span> nn2, <span class="dt">prop.chisq =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  1500 
## 
##  
##                        | nn2 
## new.valid.norm.df[, 7] |         0 |         1 | Row Total | 
## -----------------------|-----------|-----------|-----------|
##                      0 |      1360 |         4 |      1364 | 
##                        |     0.997 |     0.003 |     0.909 | 
##                        |     0.966 |     0.043 |           | 
##                        |     0.907 |     0.003 |           | 
## -----------------------|-----------|-----------|-----------|
##                      1 |        48 |        88 |       136 | 
##                        |     0.353 |     0.647 |     0.091 | 
##                        |     0.034 |     0.957 |           | 
##                        |     0.032 |     0.059 |           | 
## -----------------------|-----------|-----------|-----------|
##           Column Total |      1408 |        92 |      1500 | 
##                        |     0.939 |     0.061 |           | 
## -----------------------|-----------|-----------|-----------|
## 
## 
</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">CrossTable</span>(<span class="dt">x=</span> new.test.norm.df[,<span class="dv">7</span>], <span class="dt">y =</span> nn3, <span class="dt">prop.chisq =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  1000 
## 
##  
##                       | nn3 
## new.test.norm.df[, 7] |         0 |         1 | Row Total | 
## ----------------------|-----------|-----------|-----------|
##                     0 |       890 |         1 |       891 | 
##                       |     0.999 |     0.001 |     0.891 | 
##                       |     0.949 |     0.016 |           | 
##                       |     0.890 |     0.001 |           | 
## ----------------------|-----------|-----------|-----------|
##                     1 |        48 |        61 |       109 | 
##                       |     0.440 |     0.560 |     0.109 | 
##                       |     0.051 |     0.984 |           | 
##                       |     0.048 |     0.061 |           | 
## ----------------------|-----------|-----------|-----------|
##          Column Total |       938 |        62 |      1000 | 
##                       |     0.938 |     0.062 |           | 
## ----------------------|-----------|-----------|-----------|
## 
## 
</code></pre>
<p>The two confusion matrices seem to be very similar in terms of recall and precision. They both have missclassified a similar amount of observations as well, reflecting this comparison. This (hopefully) means that our model does a good job at describing the new test data, as was our goal.</p>
<p>//NOTE: could you provide any insight into what I might’ve missed during this assignment? I have this feeling in my gut like I’ve skipped over something important that is causing behind-the-scenes issue in my model. Because I was traveling during this assignment I want to make sure I double back on any key issues I might’ve missed when you all went over this assigment, so I can improve in my future career. Thanks, and Best.//</p>
<p>###END</p>



</body></html>